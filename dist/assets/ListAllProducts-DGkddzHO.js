import{d as ye,r as s,s as r,u as Pe,R as U,j as t,a as Ie,B as h,L as Ae,S as k,t as l}from"./index-BCta2iwk.js";import{C as Fe}from"./card-x1ywVH_7.js";import{I as ke}from"./input-mh7JJ6NP.js";import{S as W,a as H,b as M,c as q,d as C}from"./select-CD5XDIEa.js";import{P as i,T as Ee,a as Te,b as G,c as Be,d as J,C as De}from"./products.config-CpzuDxt3.js";import{H as Ke,F as ze,a as Le,C as Re}from"./FavButton-CuxTAiDO.js";import{I as _e}from"./InfoCard-BmLNuLOI.js";import{B as $e,C as Ve}from"./categories.services-BIRfYhm5.js";import{B as m}from"./users.config-Dva0wEUX.js";import{D as Oe,C as Ue,A as Q,I as We}from"./DataTable-DK8RZuQV.js";import{P as He}from"./products.services-ClCANeLJ.js";import{S as X}from"./settings.config-DOL1Dw22.js";import{S as Me}from"./settings.services-CjmHj3Qp.js";import{u as qe}from"./useCapitalize-CH2_f9x0.js";import{P as Ge}from"./plus-PRqGeHHI.js";import{P as Je}from"./pencil-DLwvTUIk.js";import"./index-BAguUWrr.js";import"./dialog-Cbf9pZRL.js";import"./useLocaleDate-D4D90Shb.js";import"./trash-2-Fv-IyTXX.js";import"./circle-check-big-Bq8s_kx7.js";import"./badge-x-BzcLBOcs.js";import"./arrow-left-CIgR4B0O.js";import"./chevron-left-By3v_zgh.js";const E="/app";function St({type:Y}){const[c,n]=ye(),[Z,ee]=s.useState([]),[te,T]=s.useState(0),[v,w]=s.useState(c.get("t")||""),[se,ae]=s.useState([]),[re,B]=s.useState(0),[p,b]=s.useState(c.get("c")||""),[D,ie]=s.useState(""),[y,P]=s.useState([]),[K,j]=s.useState([]),[I,z]=s.useState(""),[L,le]=s.useState(!1),[ce,ne]=s.useState(!1),[R,oe]=s.useState(!1),[S,de]=s.useState(!1),me=r(e=>e.rowsPerPageProducts),ue=r(e=>e.setRowsPerPageProducts),_=r.getState().setTabActive,fe=r.getState().tabActive,N=qe(),$=Pe(),he=r(e=>e.isClicked),xe=r.getState().role===U.ADMIN?t.jsx("div",{children:i.contentStatus.admin}):t.jsxs("div",{children:[i.contentStatus.user,t.jsxs("span",{className:"pl-1 font-bold",children:["(",r.getState().username,")"]}),"."]});async function ge(){$e.findAllUI().then(e=>{e.length>0&&ee(e),e.statusCode>399&&l({title:e.statusCode,description:e.message,variant:"destructive",duration:5e3}),e instanceof Error&&l({title:"Error",description:"500 Internal Server Error | "+e.message,variant:"destructive",duration:5e3})})}async function ve(){Ve.findAllUI().then(e=>{e.length>0&&ae(e),e.statusCode>399&&l({title:e.statusCode,description:e.message,variant:"destructive",duration:5e3}),e instanceof Error&&l({title:"Error",description:"500 Internal Server Error | "+e.message,variant:"destructive",duration:5e3})})}async function A(){He.findAllClient().then(e=>{Array.isArray(e)&&(e.length>0?(oe(!0),pe(e),le(!0)):ne(!0)),e.statusCode>399&&l({title:e.statusCode,description:e.message,variant:"destructive",duration:5e3}),e instanceof Error&&l({title:"Error",description:"500 Internal Server Error | "+e.message,variant:"destructive",duration:5e3})})}async function pe(e){ze.findAll().then(a=>{if(a.length>0){const x=e.map(o=>({...o,isFavorite:a.map(d=>d.propertyId).includes(o.id)}));j(x),P(x)}else a.length===0&&(j(e),P(e));a.statusCode>399&&l({title:a.statusCode,description:a.message,variant:"destructive",duration:5e3}),a instanceof Error&&l({title:"Error",description:"500 Internal Server Error | "+a.message,variant:"destructive",duration:5e3})})}async function je(){Me.findOne("rowsPerPageProducts").then(e=>{ue(Number(e.value))})}s.useEffect(()=>{je(),ge(),ve(),A(),he(0)},[]);const Se=[{accessorKey:"id",header:()=>t.jsx("div",{className:"text-center",children:i.headers[0]}),cell:({row:e})=>t.jsxs("div",{className:"flex flex-row items-center justify-center space-x-4",children:[t.jsx(Le,{property:e.original,height:18}),t.jsxs("div",{children:[" ",e.original.deletedAt?t.jsx(Ue,{className:"h-4 w-4"}):t.jsx("div",{className:"flex h-4 w-4 items-center rounded-full border pl-1 "+(e.original.is_active?"border-emerald-400 bg-emerald-300":"border-slate-300/50 bg-input")})]}),t.jsx("div",{className:"rounded-sm border bg-slate-200/70 p-1 text-xs font-bold uppercase text-slate-500",children:e.original.id<10?`COD/0${e.original.id}`:`COD/${e.original.id}`})]})},{accessorKey:"business_type",header:i.headers[1],cell:({row:e})=>t.jsx("div",{className:"text-left",children:N(e.original.business_type)})},{accessorKey:"type",header:({column:e})=>t.jsx("div",{className:"",children:t.jsxs(h,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),children:[i.headers[2],t.jsx(Q,{className:"ml-2 h-4 w-4"})]})}),cell:({row:e})=>t.jsx("div",{className:"text-left",children:N(e.original.type)})},{accessorKey:"city",header:i.headers[4]},{accessorKey:"price",header:({column:e})=>t.jsx("div",{className:"",children:t.jsxs(h,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),children:[i.headers[5],t.jsx(Q,{className:"ml-2 h-4 w-4"})]})}),cell:({row:e})=>t.jsx(Re,{value:e.original.price,locale:"es-AR",digits:0,className:"font-semibold italic tracking-tight"})},{header:i.headers[6],id:"actions",cell:({row:e})=>t.jsx("div",{className:"flex flex-row gap-2",children:e.original.deletedAt===null&&t.jsxs(t.Fragment,{children:[t.jsx(h,{onClick:()=>$(E+"/productos/"+e.original.id),variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-sky-400",children:t.jsx(We,{className:"h-5 w-5",strokeWidth:"1.5"})}),Y!=="client"&&t.jsx(h,{onClick:()=>$(`${E}/productos/modificar/${e.original.id}`),variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-emerald-400",children:t.jsx(Je,{className:"h-5 w-5",strokeWidth:"1.5"})})]})})}];function Ne(e){e==="reset"?(w(""),T(+new Date),n(O(c,"t"))):(w(e),n(p!==""?{c:p,t:e}:{t:e}))}function Ce(e){e==="reset"?(b(""),B(+new Date),n(O(c,"c"))):(b(e),n(v!==""?{c:e,t:v}:{c:e}))}function V(){w(""),T(+new Date),b(""),B(+new Date),z(""),n([])}function O(e,a){return[...e.entries()].filter(([u])=>u!==a).reduce((u,[g,f])=>({...u,[g]:f}),{})}s.useEffect(()=>{function e(a,x,o,d){const u=a.filter(g=>x.every((f,F)=>o[F]!==""?o[F]==="others"?g[f]!==r.getState().userId:g[f]===o[F]:a));return d===null&&(d=""),d!==""?u.filter(f=>f.city.toLowerCase().includes(d.toLowerCase())):u}j(e(y,["business_type","type","created_by"],[v,p,D],I))},[v,p,D,I,c,y]);function we(){const e=y.filter(a=>a.isFavorite);j(e),P(e)}function be(){de(!S),ie(""),V(),S||we(),S&&A()}return t.jsxs("main",{className:"flex-1 overflow-y-auto",children:[t.jsxs("div",{className:"mx-8 mb-8 mt-8 flex flex-row items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-normal text-slate-600",children:Ie.sidebar.menu.allProducts}),t.jsx("div",{children:t.jsx(h,{variant:"default",size:"default",asChild:!0,children:t.jsxs(Ae,{to:`${E}/productos/crear`,children:[t.jsx(Ge,{className:"mr-2 h-4 w-4"}),m.actions.create]})})})]}),t.jsxs("div",{className:"container",children:[t.jsxs(Ee,{defaultValue:fe,className:"w-full",children:[t.jsxs("div",{className:"flex flex-col rounded-md border border-slate-300 bg-slate-200 px-3 py-4 shadow-sm md:flex-row md:gap-4 md:p-2 md:pr-4",children:[t.jsx("div",{className:"flex flex-row",children:t.jsxs(Te,{className:"flex bg-inherit p-0 pl-1",children:[t.jsx(G,{value:"card",className:"font-normal",onClick:()=>_("card"),children:X.common.views.card}),t.jsx(G,{value:"list",className:"font-normal",onClick:()=>_("list"),children:X.common.views.list})]})}),t.jsx("div",{className:"flex",children:t.jsx(k,{orientation:"vertical",className:"mx-2 h-full bg-slate-400/50"})}),t.jsxs("div",{className:"mt-3 flex flex-row gap-4 md:mt-1",children:[t.jsx("div",{className:"flex h-8 w-[50%] md:w-[100px]",children:t.jsxs(W,{defaultValue:c.get("t")||"",onValueChange:e=>Ne(e),children:[t.jsx(H,{className:"h-full w-full",children:t.jsx(M,{placeholder:m.type,className:"text-sm"})}),t.jsxs(q,{children:[R&&Z.map(e=>t.jsx(C,{value:e.name,className:"text-sm",children:N(e.name)},e.id)),t.jsx(k,{orientation:"horizontal",className:" bg-slate-200"}),t.jsx(C,{value:"reset",className:"text-sm focus:text-emerald-600",children:m.filters.all},"0")]})]},te)}),t.jsx("div",{className:"flex h-8 w-[50%] md:w-[120px] lg:w-[160px]",children:t.jsxs(W,{defaultValue:c.get("c")||"",onValueChange:e=>Ce(e),children:[t.jsx(H,{className:"h-full w-full",children:t.jsx(M,{placeholder:m.category,className:"text-sm"})}),t.jsxs(q,{children:[R&&se.map(e=>t.jsx(C,{value:e.name,className:"text-sm",children:N(e.name)},e.id)),t.jsx(k,{orientation:"horizontal",className:" bg-slate-200"}),t.jsx(C,{value:"reset",className:"text-sm focus:text-emerald-600",children:m.filters.all},"0")]})]},re)})]}),t.jsxs("div",{className:"mt-4 flex flex-row gap-4 md:mt-1",children:[t.jsx("div",{className:"flex h-8 w-[50%] md:w-auto lg:w-auto",children:t.jsx(ke,{placeholder:i.search,onChange:e=>z(e==null?void 0:e.target.value),value:I,className:"h-full w-full"})}),t.jsx("div",{className:"flew-row flex h-8 w-[50%] md:w-[90px]",children:t.jsx(h,{onClick:V,variant:"slate",className:"h-8 w-full",children:m.actions.delete})})]})]}),t.jsx("div",{className:"flex flex-row pb-0 pt-4",children:t.jsx("div",{children:t.jsxs(Be,{variant:"default",size:"sm",className:"gap-2 bg-transparent text-sm font-normal text-slate-600 hover:bg-slate-200 hover:text-slate-600 data-[state=on]:bg-slate-200 data-[state=on]:font-medium data-[state=on]:text-slate-600",onClick:be,children:[t.jsx(Ke,{className:`h-4 w-4 ${S?"fill-red-500 stroke-red-500":"fill-none stroke-current"}`,strokeWidth:2}),t.jsx("span",{children:m.filters.favorites})]})})}),t.jsx(J,{value:"card",className:"pb-8 pt-2",children:L&&t.jsx(De,{type:"client",getProducts:A,properties:K})}),t.jsx(J,{value:"list",className:r.getState().role===U.ADMIN?"pb-8 pt-2":"py-6 pb-8",children:L&&t.jsx(Fe,{className:"p-6",children:t.jsx(Oe,{tableFor:"products",columns:Se,data:K,rowsPerPage:me})})})]}),ce&&t.jsx("div",{className:"flex justify-center",children:t.jsx(_e,{content:xe})})]})]})}export{St as default};
