import{c as Oe,d as Re,r as a,j as t,s as n,u as Ke,R as j,a as Le,B as l,L as We,S as W,t as i}from"./index-BCta2iwk.js";import{C as Me}from"./card-x1ywVH_7.js";import{D as _e,a as Ue,b as He,c as Ve,d as Xe,e as qe}from"./dialog-Cbf9pZRL.js";import{I as Ge}from"./input-mh7JJ6NP.js";import{S as ee,a as te,b as se,c as ae,d as I}from"./select-CD5XDIEa.js";import{P as r,T as Je,a as Qe,b as ie,c as Ye,d as re,C as Ze}from"./products.config-CpzuDxt3.js";import{H as et,F as tt,a as st,C as at}from"./FavButton-CuxTAiDO.js";import{I as it}from"./InfoCard-BmLNuLOI.js";import{B as rt,C as lt}from"./categories.services-BIRfYhm5.js";import{B as o}from"./users.config-Dva0wEUX.js";import{D as nt,C as ot,A as le,I as ct}from"./DataTable-DK8RZuQV.js";import{P as k}from"./products.services-ClCANeLJ.js";import{S as ne}from"./settings.config-DOL1Dw22.js";import{S as dt}from"./settings.services-CjmHj3Qp.js";import{u as mt}from"./useCapitalize-CH2_f9x0.js";import{P as ut}from"./plus-PRqGeHHI.js";import{P as ft}from"./pencil-DLwvTUIk.js";import{T as ht}from"./trash-2-Fv-IyTXX.js";import{C as xt}from"./circle-check-big-Bq8s_kx7.js";import{B as gt}from"./badge-x-BzcLBOcs.js";import"./index-BAguUWrr.js";import"./useLocaleDate-D4D90Shb.js";import"./arrow-left-CIgR4B0O.js";import"./chevron-left-By3v_zgh.js";/**
 * @license lucide-react v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=Oe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),M="/app";function Mt(){const[p,m]=Re(),[A,oe]=a.useState([]),[ce,_]=a.useState(0),[N,F]=a.useState(p.get("t")||""),[E,de]=a.useState([]),[me,U]=a.useState(0),[S,T]=a.useState(p.get("c")||""),[H,b]=a.useState(""),[B,w]=a.useState(1),[z,ue]=a.useState(""),[y,fe]=a.useState(!1),[he,f]=a.useState(!1),[$,O]=a.useState([]),[V,P]=a.useState([]),[h,xe]=a.useState({id:0,name:"",title:"",subtitle:"",message:t.jsx("span",{})}),[R,X]=a.useState(""),[q,ge]=a.useState(!1),[ve,je]=a.useState(!1),[G,pe]=a.useState(!1),Ce=n(e=>e.rowsPerPageProducts),Ne=n(e=>e.setRowsPerPageProducts),J=n.getState().setTabActive,Se=n.getState().tabActive,D=mt(),Q=Ke(),be=n(e=>e.isClicked),we=n.getState().role===j.ADMIN?t.jsx("div",{children:r.contentStatus.admin}):t.jsxs("div",{children:[r.contentStatus.user,t.jsxs("span",{className:"pl-1 font-bold",children:["(",n.getState().username,")"]})]});async function ye(){rt.findAllUI().then(e=>{e.length>0&&oe(e),e.statusCode>399&&i({title:e.statusCode,description:e.message,variant:"destructive",duration:5e3}),e instanceof Error&&i({title:"Error",description:"500 Internal Server Error | "+e.message,variant:"destructive",duration:5e3})})}async function Pe(){lt.findAllUI().then(e=>{e.length>0&&de(e),e.statusCode>399&&i({title:e.statusCode,description:e.message,variant:"destructive",duration:5e3}),e instanceof Error&&i({title:"Error",description:"500 Internal Server Error | "+e.message,variant:"destructive",duration:5e3})})}async function x(){k.findAll().then(e=>{Array.isArray(e)&&(e.length>0?(pe(!0),De(e),ge(!0)):je(!0)),e.statusCode>399&&i({title:e.statusCode,description:e.message,variant:"destructive",duration:5e3}),e instanceof Error&&i({title:"Error",description:"500 Internal Server Error | "+e.message,variant:"destructive",duration:5e3})})}async function De(e){tt.findAll().then(s=>{if(s.length>0){const d=e.map(c=>({...c,isFavorite:s.map(u=>u.propertyId).includes(c.id)}));P(d),O(d)}else s.length===0&&(P(e),O(e));s.statusCode>399&&i({title:s.statusCode,description:s.message,variant:"destructive",duration:5e3}),s instanceof Error&&i({title:"Error",description:"500 Internal Server Error | "+s.message,variant:"destructive",duration:5e3})})}async function Ie(){dt.findOne("rowsPerPageProducts").then(e=>{Ne(Number(e.value))})}a.useEffect(()=>{Ie(),ye(),Pe(),x(),be(2)},[]);const ke=[{accessorKey:"id",header:()=>t.jsx("div",{className:"text-center",children:r.headers[0]}),cell:({row:e})=>t.jsxs("div",{className:"flex flex-row items-center justify-center space-x-4",children:[t.jsx(st,{property:e.original,height:18}),t.jsxs("div",{children:[" ",e.original.deletedAt?t.jsx(ot,{className:"h-4 w-4"}):t.jsx("div",{className:"flex h-4 w-4 items-center rounded-full border pl-1 "+(e.original.is_active?"border-emerald-400 bg-emerald-300":"border-slate-300/50 bg-input")})]}),t.jsx("div",{className:"rounded-sm border bg-slate-200/70 p-1 text-xs font-bold uppercase text-slate-500",children:e.original.id<10?`COD/0${e.original.id}`:`COD/${e.original.id}`})]})},{accessorKey:"business_type",header:r.headers[1],cell:({row:e})=>t.jsx("div",{className:"text-left",children:D(e.original.business_type)})},{accessorKey:"type",header:({column:e})=>t.jsx("div",{className:"",children:t.jsxs(l,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),children:[r.headers[2],t.jsx(le,{className:"ml-2 h-4 w-4"})]})}),cell:({row:e})=>t.jsx("div",{className:"text-left",children:D(e.original.type)})},{accessorKey:"city",header:r.headers[4]},{accessorKey:"price",header:({column:e})=>t.jsx("div",{className:"",children:t.jsxs(l,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),children:[r.headers[5],t.jsx(le,{className:"ml-2 h-4 w-4"})]})}),cell:({row:e})=>t.jsx(at,{value:e.original.price,locale:"es-AR",digits:0,className:"font-semibold italic tracking-tight"})},{header:r.headers[6],id:"actions",cell:({row:e})=>t.jsxs("div",{className:"flex flex-row gap-2",children:[e.original.deletedAt===null&&t.jsxs(t.Fragment,{children:[t.jsx(l,{onClick:()=>Q(M+"/productos/"+e.original.id),variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-sky-400",children:t.jsx(ct,{className:"h-5 w-5",strokeWidth:"1.5"})}),t.jsx(l,{onClick:()=>Q(`${M}/productos/modificar/${e.original.id}`),variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-emerald-400",children:t.jsx(ft,{className:"h-5 w-5",strokeWidth:"1.5"})})]}),e.original.deletedAt===null?t.jsx(l,{onClick:()=>K(e.original,"removeSoft"),variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-rose-400",children:t.jsx(ht,{className:"h-5 w-5",strokeWidth:"1.5"})}):t.jsx(l,{onClick:()=>K(e.original,"restore"),variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-emerald-400",children:t.jsx(xt,{className:"h-5 w-5",strokeWidth:"1.5"})}),n.getState().role===j.ADMIN&&t.jsx(l,{onClick:()=>K(e.original,"remove"),variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-rose-400",children:t.jsx(gt,{className:"h-5 w-5",strokeWidth:"1.5"})})]})}];function Ae(e){e==="reset"?(F(""),_(+new Date),m(Z(p,"t"))):(F(e),m(S!==""?{c:S,t:e}:{t:e}))}function Fe(e){e==="reset"?(T(""),U(+new Date),m(Z(p,"c"))):(T(e),m(N!==""?{c:e,t:N}:{c:e}))}function Y(){F(""),_(+new Date),T(""),U(+new Date),X(""),m([])}function Z(e,s){return[...e.entries()].filter(([g])=>g!==s).reduce((g,[C,v])=>({...g,[C]:v}),{})}a.useEffect(()=>{function e(s,d,c,u){const g=s.filter(C=>d.every((v,L)=>c[L]!==""?c[L]==="others"?C[v]!==n.getState().userId:C[v]===c[L]:s));return u===null&&(u=""),u!==""?g.filter(v=>v.city.toLowerCase().includes(u.toLowerCase())):g}P(e($,["business_type","type","created_by"],[N,S,H],R))},[N,S,H,R,p,$]);function K(e,s){let d=!1,c="";s==="removeSoft"&&(c=r.dialog.possibleRevertion,d=t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{children:r.dialog.propertySoftDelete}),t.jsx("span",{className:"text-md font-bold text-slate-900",children:e.id<10?`COD/0${e.id}`:`COD/${e.id}`})]})),s==="remove"&&(c=r.dialog.impossibleRevertion,d=t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{children:r.dialog.propertyDelete}),t.jsx("span",{className:"text-md font-bold text-slate-900",children:e.id<10?`COD/0${e.id}`:`COD/${e.id}`})]})),s==="restore"&&(c=r.dialog.possibleRevertion,d=t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{children:r.dialog.propertyRestore}),t.jsx("span",{className:"text-md font-bold text-slate-900",children:e.id<10?`COD/0${e.id}`:`COD/${e.id}`})]})),f(!0),xe({id:Number(e.id),name:e.title,title:r.dialog.title,subtitle:c,message:d}),ue(s)}async function Ee(e){k.restore(e).then(s=>{s.statusCode===200&&(i({title:s.statusCode,description:s.message,variant:"success",duration:5e3}),x()),s.statusCode>399&&i({title:s.statusCode,description:s.message,variant:"destructive",duration:5e3}),s instanceof Error&&i({title:"Error",description:"500 Internal Server Error | "+s.message,variant:"destructive",duration:5e3}),f(!1)})}async function Te(e){k.removeSoft(e).then(s=>{s.statusCode===200&&(i({title:s.statusCode,description:s.message,variant:"success",duration:5e3}),x()),s.statusCode>399&&i({title:s.statusCode,description:s.message,variant:"destructive",duration:5e3}),s instanceof Error&&i({title:"Error",description:"500 Internal Server Error | "+s.message,variant:"destructive",duration:5e3})}),f(!1)}async function Be(e){k.remove(e).then(s=>{s.statusCode===200&&(i({title:s.statusCode,description:s.message,variant:"success",duration:5e3}),x()),s.statusCode>399&&i({title:s.statusCode,description:s.message,variant:"destructive",duration:5e3}),s instanceof Error&&i({title:"Error",description:"500 Internal Server Error | "+s.message,variant:"destructive",duration:5e3})}),f(!1)}async function ze(){const e=$.filter(s=>s.isFavorite);P(e),O(e)}function $e(){fe(!y),w(1),b(""),Y(),y||ze(),y&&x()}return t.jsxs("main",{className:"flex-1 overflow-y-auto",children:[t.jsxs("div",{className:"mx-8 mb-8 mt-8 flex flex-row items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-normal text-slate-600",children:Le.sidebar.menu.products}),t.jsx("div",{children:t.jsx(l,{variant:"default",size:"default",asChild:!0,children:t.jsxs(We,{to:`${M}/productos/crear`,children:[t.jsx(ut,{className:"mr-2 h-4 w-4"}),o.actions.create]})})})]}),t.jsxs("div",{className:"container",children:[t.jsxs(Je,{defaultValue:Se,className:"w-full",children:[t.jsxs("div",{className:"flex flex-col rounded-md border border-slate-300 bg-slate-200 px-3 py-4 shadow-sm md:flex-row md:gap-4 md:p-2 md:pr-4",children:[t.jsx("div",{className:"flex flex-row",children:t.jsxs(Qe,{className:"flex bg-inherit p-0 pl-1",children:[t.jsx(ie,{value:"card",className:"font-normal",onClick:()=>J("card"),children:ne.common.views.card}),t.jsx(ie,{value:"list",className:"font-normal",onClick:()=>J("list"),children:ne.common.views.list})]})}),t.jsx("div",{className:"flex",children:t.jsx(W,{orientation:"vertical",className:"mx-2 h-full bg-slate-400/50"})}),t.jsxs("div",{className:"mt-3 flex flex-row gap-4 md:mt-1",children:[t.jsx("div",{className:"flex h-8 w-[50%] md:w-[100px]",children:t.jsxs(ee,{onValueChange:e=>Ae(e),children:[t.jsx(te,{className:"h-full w-full",children:t.jsx(se,{placeholder:o.type,className:"text-sm"})}),t.jsxs(ae,{children:[G&&(A==null?void 0:A.map(e=>t.jsx(I,{value:e.name,className:"text-sm",children:D(e.name)},e.id))),t.jsx(W,{orientation:"horizontal",className:" bg-slate-200"}),t.jsx(I,{value:"reset",className:"text-sm focus:text-emerald-600",children:o.filters.all},"0")]})]},ce)}),t.jsx("div",{className:"flex h-8 w-[50%] md:w-[120px] lg:w-[160px]",children:t.jsxs(ee,{onValueChange:e=>Fe(e),children:[t.jsx(te,{className:"h-full w-full",children:t.jsx(se,{placeholder:o.category,className:"text-sm"})}),t.jsxs(ae,{children:[G&&(E==null?void 0:E.map(e=>t.jsx(I,{value:e.name,className:"text-sm",children:D(e.name)},e.id))),t.jsx(W,{orientation:"horizontal",className:" bg-slate-200"}),t.jsx(I,{value:"reset",className:"text-sm focus:text-emerald-600",children:o.filters.all},"0")]})]},me)})]}),t.jsxs("div",{className:"mt-4 flex flex-row gap-4 md:mt-1",children:[t.jsx("div",{className:"flex h-8 w-[50%] md:w-auto lg:w-auto",children:t.jsx(Ge,{placeholder:r.search,onChange:e=>X(e==null?void 0:e.target.value),value:R,className:"h-full w-full"})}),t.jsx("div",{className:"flew-row flex h-8 w-[50%] md:w-[90px]",children:t.jsx(l,{onClick:Y,variant:"slate",className:"h-8 w-full",children:o.actions.delete})})]})]}),n.getState().role===j.ADMIN&&t.jsxs("section",{className:"flex flex-row space-x-4 pl-2 pt-4",children:[t.jsxs("div",{className:"flex flex-row items-center space-x-2 text-sm text-slate-600",children:[t.jsx(vt,{className:"h-4 w-4",strokeWidth:"2"}),t.jsx("span",{children:r.filters.byCreator})]}),t.jsxs("div",{className:"flex flex-row items-center space-x-1 text-sm text-slate-600",children:[t.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{w(1),b("")},className:B===1?"bg-slate-200":"bg-transparent",children:o.filters.all}),t.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{w(2),b(n.getState().userId)},className:B===2?"bg-slate-200":"bg-transparent",children:o.filters.yours}),t.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{w(3),b("others")},className:B===3?"bg-slate-200":"bg-transparent",children:o.filters.others})]})]}),t.jsx("div",{className:`flex flex-row ${n.getState().role===j.ADMIN?"pb-4 pt-2":"pb-0 pt-4"}`,children:t.jsx("div",{children:t.jsxs(Ye,{variant:"default",size:"sm",className:"gap-2 bg-transparent text-sm font-normal text-slate-600 hover:bg-slate-200 hover:text-slate-600 data-[state=on]:bg-slate-200 data-[state=on]:font-medium data-[state=on]:text-slate-600",onClick:$e,children:[t.jsx(et,{className:`h-4 w-4 ${y?"fill-red-500 stroke-red-500":"fill-none stroke-current"}`,strokeWidth:2}),t.jsx("span",{children:o.filters.favorites})]})})}),t.jsx(re,{value:"card",className:n.getState().role===j.ADMIN?"pb-8 pt-2":"py-6 pb-8",children:q&&t.jsx(Ze,{getProducts:x,properties:V})}),t.jsx(re,{value:"list",className:n.getState().role===j.ADMIN?"pb-8 pt-2":"py-6 pb-8",children:q&&t.jsx(Me,{className:"p-6",children:t.jsx(nt,{tableFor:"products",columns:ke,data:V,rowsPerPage:Ce})})})]}),ve&&t.jsx("div",{className:"flex justify-center",children:t.jsx(it,{content:we})})]}),t.jsx(_e,{open:he,onOpenChange:f,children:t.jsxs(Ue,{children:[t.jsxs(He,{children:[t.jsx(Ve,{children:h.title}),t.jsx(Xe,{children:h.subtitle})]}),t.jsx("section",{className:"text-sm font-normal",children:h.message}),t.jsx(qe,{children:t.jsxs("div",{className:"mt-6 flex flex-row gap-4",children:[t.jsx(l,{variant:"ghost",onClick:()=>f(!1),children:o.actions.cancel}),z==="removeSoft"&&t.jsx(l,{variant:"delete",onClick:()=>Te(h.id),children:o.actions.delete}),z==="restore"&&t.jsx(l,{variant:"default",onClick:()=>Ee(h.id),children:o.actions.restore}),z==="remove"&&t.jsx(l,{variant:"delete",onClick:()=>Be(h.id),children:o.actions.delete})]})})]})})]})}export{Mt as default};
