import{r as o,j as e,s as d,u as L,R as W,a as F,B as a,L as p,D as b,U as h,t as r}from"./index-BCta2iwk.js";import{C as T}from"./card-x1ywVH_7.js";import{D as M,a as O,b as H,c as X,d as Y,e as _}from"./dialog-Cbf9pZRL.js";import{B as c,U as i}from"./users.config-Dva0wEUX.js";import{D as q,A as j,C as G,I as J}from"./DataTable-DK8RZuQV.js";import{R as Q}from"./roles.services-DDusMnZx.js";import{u as V}from"./useCapitalize-CH2_f9x0.js";import{P as Z}from"./plus-PRqGeHHI.js";import{P as S}from"./pencil-DLwvTUIk.js";import{T as ee}from"./trash-2-Fv-IyTXX.js";import{C as te}from"./circle-check-big-Bq8s_kx7.js";import{B as se}from"./badge-x-BzcLBOcs.js";import"./select-CD5XDIEa.js";import"./index-BAguUWrr.js";import"./settings.services-CjmHj3Qp.js";import"./arrow-left-CIgR4B0O.js";import"./chevron-left-By3v_zgh.js";const x="/app";function Ce(){const[g,f]=o.useState(""),[m,D]=o.useState(!1),[I,l]=o.useState(!1),[k,E]=o.useState([]),[w,N]=o.useState(0),[n,v]=o.useState({id:0,name:"",title:"",subtitle:"",message:e.jsx("span",{})}),[A,U]=o.useState([]),y=V(),R=d(t=>t.rowsPerPageUsers),C=L(),P=[{accessorKey:"id",header:({column:t})=>e.jsx("div",{className:"text-center",children:e.jsxs(a,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:[i.headers[0],e.jsx(j,{className:"ml-2 h-4 w-4"})]})}),cell:({row:t})=>e.jsx("div",{className:"text-center",children:t.original.id})},{accessorKey:"type",header:"",cell:({row:t})=>{const s=t.original;return e.jsx(e.Fragment,{children:s.deletedAt!==null?e.jsx(G,{className:"h-4 w-4"}):e.jsx(b,{role:s.role,width:"14px"})})}},{accessorKey:"name",header:({column:t})=>e.jsx("div",{className:"text-left",children:e.jsxs(a,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:[i.headers[1],e.jsx(j,{className:"ml-2 h-4 w-4"})]})})},{accessorKey:"email",header:({column:t})=>e.jsx("div",{className:"text-left",children:e.jsxs(a,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:[i.headers[2],e.jsx(j,{className:"ml-2 h-4 w-4"})]})})},{accessorKey:"phone",header:i.headers[3]},{header:i.headers[4],id:"actions",cell:({row:t})=>e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(a,{onClick:()=>C(`${x}/usuario/${Number(t.original.id)}`),variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-sky-400",children:e.jsx(J,{className:"h-5 w-5",strokeWidth:"1.5"})}),(m||d.getState().userId===Number(t.original.id)&&!m)&&e.jsxs(e.Fragment,{children:[t.original.deletedAt===null&&e.jsx(a,{onClick:()=>C(`${x}/usuario/modificar/${Number(t.original.id)}`),variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-emerald-400",children:e.jsx(S,{className:"h-5 w-5",strokeWidth:"1.5"})}),t.original.deletedAt===null?e.jsx(a,{onClick:()=>{l(!0),v({id:Number(t.original.id),name:t.original.name,title:i.dialog.title,subtitle:i.dialog.impossibleRevertion,message:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-md font-bold text-slate-900",children:t.original.name}),i.dialog.userSoftDelete]})}),f("removeSoft")},variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-rose-400",children:e.jsx(ee,{className:"h-5 w-5",strokeWidth:"1.5"})}):e.jsx(a,{onClick:()=>{l(!0),v({id:Number(t.original.id),name:t.original.name,title:i.dialog.title,subtitle:i.dialog.possibleRevertion,message:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-md font-bold text-slate-900",children:t.original.name}),i.dialog.userRestore]})}),f("restore")},variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-emerald-400",children:e.jsx(te,{className:"h-5 w-5",strokeWidth:"1.5"})}),d.getState().userId!==Number(t.original.id)&&e.jsx(a,{onClick:()=>{l(!0),v({id:Number(t.original.id),name:t.original.name,title:i.dialog.title,subtitle:i.dialog.impossibleRevertion,message:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-md font-bold text-slate-900",children:t.original.name}),i.dialog.userDelete]})}),f("remove")},variant:"outline",size:"miniIcon",className:"hover:bg-white hover:text-rose-400",children:e.jsx(se,{className:"h-5 w-5",strokeWidth:"1.5"})})]})]})}];async function u(){h.getAll().then(t=>{t.length>0&&U(t),t.statusCode>399&&r({title:t.statusCode,description:t.message,variant:"destructive",duration:5e3}),t instanceof Error&&r({title:"Error",description:"500 Internal Server Error | "+t.message,variant:"destructive",duration:5e3})})}async function z(){Q.findAll().then(t=>{t.length>0&&E(t),t.statusCode>399&&r({title:t.statusCode,description:t.message,variant:"destructive",duration:5e3}),t instanceof Error&&r({title:"Error",description:"500 Internal Server Error | "+t.message,variant:"destructive",duration:5e3})})}o.useEffect(()=>{D(d.getState().role===W.ADMIN),u(),z()},[w]);function B(t){h.removeSoft(t).then(s=>{s.statusCode===200&&(r({title:s.statusCode,description:s.message,variant:"success",duration:5e3}),u(),N(Math.random())),s.statusCode>399&&r({title:s.statusCode,description:s.message,variant:"destructive",duration:5e3}),s instanceof Error&&r({title:"Error",description:"500 Internal Server Error | "+s.message,variant:"destructive",duration:5e3}),l(!1)})}function $(t){h.restore(t).then(s=>{s.statusCode===200&&(r({title:s.statusCode,description:s.message,variant:"success",duration:5e3}),u(),N(Math.random())),s.statusCode>399&&r({title:s.statusCode,description:s.message,variant:"destructive",duration:5e3}),s instanceof Error&&r({title:"Error",description:"500 Internal Server Error | "+s.message,variant:"destructive",duration:5e3}),l(!1)})}function K(t){h.remove(t).then(s=>{s.statusCode===200&&(r({title:s.statusCode,description:s.message,variant:"success",duration:5e3}),u()),s.statusCode>399&&r({title:s.statusCode,description:s.message,variant:"destructive",duration:5e3}),s instanceof Error&&r({title:"Error",description:"500 Internal Server Error | "+s.message,variant:"destructive",duration:5e3}),l(!1)})}return e.jsxs("main",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between px-8 pt-8",children:[e.jsx("h1",{className:"text-2xl font-normal text-slate-600",children:F.sidebar.menu.users}),m&&e.jsx(a,{variant:"default",size:"default",asChild:!0,children:e.jsxs(p,{to:`${x}/usuario/crear`,children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),c.actions.create]})}),!m&&e.jsx(a,{variant:"default",size:"default",asChild:!0,children:e.jsxs(p,{to:`${x}/usuario/modificar/${d.getState().userId}`,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),i.buttons.editYourData]})})]}),e.jsx("div",{className:"container mx-auto pt-8",children:e.jsx(T,{className:"p-6",children:e.jsx(q,{tableFor:"users",columns:P,data:A,rowsPerPage:R})})}),e.jsx("div",{className:"mt-6 flex flex-row justify-start px-8",children:k.map(t=>e.jsxs("div",{className:"mr-6 flex flex-row items-center space-x-2 text-sm font-light text-slate-500",children:[e.jsx(b,{role:t.value,width:"14px"}),e.jsx("span",{children:y(t.title)})]},t.id))}),e.jsx(M,{open:I,onOpenChange:l,children:e.jsxs(O,{children:[e.jsxs(H,{children:[e.jsx(X,{children:n.title}),e.jsx(Y,{children:n.subtitle})]}),e.jsx("section",{className:"text-sm font-normal",children:n.message}),e.jsx(_,{children:e.jsxs("div",{className:"mt-6 flex flex-row gap-4",children:[e.jsx(a,{variant:"ghost",onClick:()=>l(!1),children:c.actions.cancel}),g==="removeSoft"&&e.jsx(a,{variant:"delete",onClick:()=>B(n.id),children:c.actions.delete}),g==="restore"&&e.jsx(a,{variant:"default",onClick:()=>$(n.id),children:c.actions.restore}),g==="remove"&&e.jsx(a,{variant:"delete",onClick:()=>K(n.id),children:c.actions.delete})]})})]})})]})}export{Ce as default};
