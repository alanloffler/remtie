import{s as a,r as d,u as F,j as e,B as P}from"./index-BCta2iwk.js";import{C as E,a as R,b as A,c as T,d as U}from"./card-x1ywVH_7.js";import{z as n,u as L,F as k,a as m,b as u,c as x,d as h,e as f,t as z}from"./zod-D9tdBR2H.js";import{I as j}from"./input-mh7JJ6NP.js";import{S as g}from"./settings.services-CjmHj3Qp.js";import"./label-D3hEH840.js";const r={title:"Remtie",subtitle:"Ingresá tus datos para acceder a la aplicación",email:"E-mail",password:"Contraseña",login:"Ingresar",errors:{invalidEmail:"Formato de e-mail inválido",invalidPassword:"La contraseña debe poseer al menos 6 caracteres"}},O="http://localhost:4000/api",M=`${O}/auth/login`,_=n.object({email:n.string().email({message:r.errors.invalidEmail}),password:n.string().min(6,{message:r.errors.invalidPassword})});function J(){const p=a.getState().setAuthorized,v=a.getState().setAuthToken,w=a.getState().setUserId,S=a.getState().setRole,b=a(t=>t.setTabActive),N=a(t=>t.setRowsPerPageUsers),[l,c]=d.useState(),I=F(),o=L({resolver:z(_),defaultValues:{email:"",password:""}});d.useEffect(()=>{a.setState({authorized:!1})},[]);async function C(t){y(t).then(s=>{s.token&&s.userId&&(v(s.token),w(Number(s.userId)),p(!0),S(s.role),g.findOne("defaultView").then(i=>{b(i.value)}),g.findOne("rowsPerPageUsers").then(i=>{N(Number(i.value))}),I("/app")),s.statusCode>399&&c(s.message),s instanceof Error&&c("500 Internal Server Error | "+s.message)})}async function y(t){try{return await(await fetch(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}catch(s){return s}}return e.jsx("div",{className:"mt-8",children:e.jsxs(E,{className:"mx-8 md:mx-auto md:w-[400px] lg:mx-auto",children:[e.jsxs(R,{className:"space-y-1",children:[e.jsx(A,{className:"text-2xl font-bold",children:r.title}),e.jsx(T,{children:r.subtitle})]}),e.jsxs(U,{children:[e.jsx(k,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(C),children:[e.jsxs("div",{className:"mt-4 flex flex-col gap-6",children:[e.jsx("div",{className:"w-full",children:e.jsx(m,{control:o.control,name:"email",render:({field:t})=>e.jsxs(u,{children:[e.jsx(x,{children:r.email}),e.jsx(h,{children:e.jsx(j,{id:"email",...t})}),e.jsx(f,{})]})})}),e.jsx("div",{className:"w-full",children:e.jsx(m,{control:o.control,name:"password",render:({field:t})=>e.jsxs(u,{className:"",children:[e.jsx(x,{children:r.password}),e.jsx(h,{children:e.jsx(j,{id:"password",type:"password",...t})}),e.jsx(f,{})]})})})]}),e.jsx("div",{className:"mt-12",children:e.jsx(P,{className:"w-full",type:"submit",children:r.login})})]})}),e.jsx("div",{className:"pt-6 text-center text-sm text-rose-400",children:l&&e.jsx("p",{children:l})})]})]})})}export{J as default};
